* # WLED GetPixy File Processing System User Guide

  

  ```
   _    _  _      _____ ______             
  | |  | || |    |  ___||  _  \            
  | |  | || |    | |__  | | | |            
  | |/\| || |    |  __| | | | |            
  \  /\  /| |____| |___ | |/ /             
   \/  \/ \_____/\____/ |___/              
                                           
                                           
   _____        _   ______  _              
  |  __ \      | |  | ___ \(_)             
  | |  \/  ___ | |_ | |_/ / _ __  __ _   _ 
  | | __  / _ \| __||  __/ | |\ \/ /| | | |
  | |_\ \|  __/| |_ | |    | | >  < | |_| |
   \____/ \___| \__|\_|    |_|/_/\_\ \__, |
                                      __/ |
                                     |___/ 
  - Convert images to WLED 2D Matrixes with ease.
  - Script your own events for an icon change and more.
  
  - By Michael van den Heever
  
  ```


  Buy me a beer, for the love of LED's

  https://www.paypal.com/donate/?business=LWK64EZBGDCRS&no_recurring=0&item_name=Greetings%2C+your+patronage+keeps+me+building+more+for+you.&currency_code=CAD


![getpixy](getpixy.jpg)

# GetPixy Configuration and Usage Guide

## Basics

GetPixy's primary requirement is that you have WLED installed on an ESP32 with the latest release, and it's important that you have a 2D Matrix setup and that your serpentine configuration is correct.  If you see a scrambled image, you likely dont have your matrix configured correctly.  If you have 1 16x16 panel, it's quite simple, but if you have 32x32 panel, it likely consists of 4 panels.  If WLED's 2D Matrix effects are displaying correctly, your in good shape to continue.

Please go through this entire document before requesting support via email.

## Extremely Simple Overview

In action: https://www.youtube.com/watch?v=_8Y0_RWQHCM

You can use this one one of two to use GetPixy.

1. **Windows .exe fashion**

   1. Download Windows Asset (.zip File)
   2. Extract contents into a folder
   3. Configure convert.cfg, enter WLED ipaddress, brightness (0-100) of frames sent and resolution for example 8x8,16x16, 32x32 (There is no limit here)
   4. Run GetPixy.exe (which will create additional default folders)
   5. Drop a .png / .jpg or .gif in the monitor folder
   6. For custom scripting please refer to the **Advanced Guide & Details**

2. **Python fashion**

   1. Download GetPixy-Python Asset (.zip file)

   2. Extract contents into a folder

   3. Configure convert.cfg, enter WLED ipaddress, brightness (0-100) of frames sent and resolution for example 8x8,16x16, 32x32 (There is no limit here)

   4. We expect you to have installed your Python3 environment

   5. pip install -r requirements.txt

   6. run python monitor.py

   7. Drop a .png / .jpg or .gif in the monitor folder

   8. For custom scripting please refer to the **Advanced Guide**

      

If you have any questions, https://www.reddit.com/r/GetPixy/ apply, we will accept you and address your concerns there for others to learn.

## Advanced Guide & Details

  #### Running `monitor.py`

1. Builds folder names based on the contents `monitor.cfg`.
       1. locations are folders, and the could be adjusted accordingly, if they dont exist, when you run monitor.py it will create them. The archive location could be configure to custom locations (as with all locations in monitor.cfg)
              1. `archive_location = archive`  **(*Default works in any OS*)**
              2. In windows ...  `archive_location = c:\pixy\archive`
              3. In Linux ... `archive_location = /home/user/pixy/archive`	
2. Default folders are created when you run monitor.py or GetPixy.exe for the first time: (these will change if you modify the config file - be warned!)
 - **`send_data_archive_location`** (this folder keeps a copy of frames that were just converted when you dropped an image.) 
 - **`send_location`** This folder is used to send the frame files.
 - **`send_data_archive_location`** Keeps a copy of every picture you dump in monitor (gets moved automatically)
 - **`monitor_location`** Where you drop an image file, main processing folder.
 - **`cronpics_location`** Where you drop images in preparation for use with `cron.py`

## Process Flow

How Images are converted and sent to your WLED device.
   - A picture is dropped into `monitor` folder.
   - Frames are generated by `convert.py`and sent to the `send` folder.
   - Frames are pushed to WLED Device using `push.py` automatically.
   - Frames that were sent get copied to `send_data_archive` gives you a change to copy them somewhere for scripting purposes.
   - The `send` folder is always cleared after processing.

# Files

> ### monitor.cfg
>

  - `move_to_archive`: Saves processed images in `archive_folder_path` (yes/no).
  - `archive_folder_path`: Storage path for archived images.
  - `monitor_location`: Directory monitored for new images.
  - `send_location`: Location where `.send` files are created.
  - `send_data_archive_location`: Temporary storage for send frames data (gets wiped out on each run).

> ### convert.cfg
>

  - `ipaddress`: IP address of WLED device.
  - `brightness`: Brightness setting for LED display. (Don't set too low or some colours will not appear)
  - `resolution`: Resolution of LED matrix. Format (16x16 or 32x32 and so on)

  ## Scripts Usage Files

> ### convert.py
>
>   Converts an image file to  Json `.send` frames for WLED.
>

  - **Syntax**: `python convert.py [path_to_image] [output_folder]`
    - formats allowed : png, jpg or gif
  - **Example**: `python convert.py path\file.jpg path\folder`

> ### push.py

 pushes `.send` files to WLED device.

  - **Syntax** for push:

- For a folder: `python push.py -folder [path_to_folder]` this is normally used for a gif, since it might comprise of multiple frame send files.

      - This will process ALL frame files in a folder, this is useful for gifs, as they have a bunch of frames, this will send them all to WLED, for small matrices it might animate too quick, so use -time function to add 100 milliseconds to slow them down. 

    - Sending a specific frame file: `python push.py -file [path_to_file]` 
      - this is used for sending a single frame file from a jpg or a png
    - With a delay between frames: `python push.py -folder [path_to_folder] -time [milliseconds]` 
      - creates a delay between frames.

- With looping: `python push.py -folder [path_to_folder] -loop [count]`

  - **Examples**:
    - Sending all `.send` files in a folder: 
      - `python push.py -folder C:\path\`
    - Sending a specific file: 
    - `python push.py -folder C:\path\ -file C:\path\file.send`
    - With a delay (for gifs, frame sets): `python push.py -folder C:\path\ -time 1000`
    - Looping the send process: `python push.py -folder C:\path\to\send_location -loop 3`

  

  > ### cron.py

  Once the `monitor.py` script is operational, it cooperates with `cron.py` to observe the `cronpics` folder. This setup ensures that every image file in `cronpics` is systematically transferred to the monitor's processing directory at regular intervals, as defined in seconds. To initiate the process, you just need to populate `cronpics` with a collection of images and activate the cycle. This system is designed to adapt in real time, allowing for ongoing updates during its operation.

  The potential applications of this arrangement are broad and can be shaped by your imagination. It's important to note that this functionality hinges on the continuous operation of `monitor.py` or its executable form. While alternative scheduling tools could also be employed to direct images to the monitor folder, this method offers a straightforward solution for those without such preferences. The monitor script processes each image sequentially and then ceases, unlike this cycle which continually operates. You maintain control over this process; to halt the cycle, simply stop running `cron.py`.
  
  **Syntax** for cron picture cycle
  
  `python cron.py -time [seconds]`
  
  
  
  
  
  ## Use Case Example
  
  Bob wants to send a custom image based on two conditions.  One when he receives a new email, and 2nd when a certain date comes along 14 February another image is sent to his matrix.
  
  1. Bob creates a folders for the frames.
  2. Folder 1 - Email, Folder 2 = Heart (Why not all in one folder, because frame files can span more than one due to color complexity especially with large matrixes like 32x32, if you use small matrixes all your converts are likely one frame file. )
  3. Bob converts his email image, Bob runs the convert in the same folder where the .cfg files are, because Bobs smart.
  1. python convert.py c:\pics\email.jpg c:\pixy\myarchive\email
     2. python convert.py c:\pics\heart.png c:\pixy\myarchive\heart
  4. Bob tests the frames
     1. python push.py -folder c:\pixy\myarchive\email
     2. python push.py -folder c:\pixy\myarchive\heart
5. Bob creates is own scripts / trigger's that will call the push statements.
  6. Bob decides to do a gif too, he wants a spinning hear to show too.
  7. Bob creates a folder c:\pixy\myarchive\spin_heart
     1. python convert.py c:\pics\spin_heart.gif c:\pixy\myarchive\spin_heart
  8. Bob tries it out
     1. python push.py -folder c:\pixy\myarchive\spin_heart
     2. Wow too fast
     3. python push.py -folder c:\pixy\myarchive\spin_heart -time 100
     4. Great .. but I want it to spin 5 times
     5. python push.py -folder c:\pixy\myarchive\spin_heart -time 100 -loop 5
     6. Awesome !!!
  9. Bobs happy, Bob buys more LED's

  

## Building for docker

  docker build -t getpixy .

  ### Running this in docker

  docker run -v "$(pwd)/monitor:/app/monitor" -v "$(pwd)/convert.cfg:/app/convert.cfg" -v "$(pwd)/monitor.cfg:/app/monitor.cfg" getpixy:latest

  if your using docker for windows:

  docker run -v "%cd%\monitor:/app/incoming" -v "%cd%\convert.cfg:/app/convert.cfg" -v "%cd%\monitor.cfg:/app/monitor.cfg" getpixy:latest



